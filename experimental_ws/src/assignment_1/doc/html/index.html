<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Assignment_1: Behavioral Architecture - Assignment 1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Assignment_1
   &#160;<span id="projectnumber">v.1</span>
   </div>
   <div id="projectbrief">Behavioral Architecture</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Behavioral Architecture - Assignment 1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><b>Author:</b> Roberto Albanese</li>
<li><b>Version:</b> 1.0</li>
<li><b>Date:</b> 10-28-2020</li>
</ul>
<h2>Indrodution</h2>
<p>This is the first assignment of the course <em>Experimental Robotics</em>. I am asked to build an ROS architecture to implement a dog alike robotâ€™s behavior. In this project folder the reader will encounter the following folders:</p><ul>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/doc/html">doc</a> Doxygen documentation</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/launch">launch</a> Launch files</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/src">src</a> Source files</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/srv">srv</a> Service files</li>
</ul>
<h2>Software Architecture and System's Features</h2>
<p>The scenario is represented by a robot, simulating a pet, that interacts with a human and moves in a discrete 2D environment. <br />
 The robot has three possible behaviors: it can Sleep, Play or stay in a Normal state.<br />
<br />
 In the Normal state the robot has to move randomly.<br />
<br />
 In the Sleep state the robot chooses a random location and sleep there for a random amount of time. Then it will go back in the Normal state. The robot can pass to the Spleep state only from the Normal state in a random time instant.<br />
<br />
 In the Play state the robot reaches the User and waits untill it points to a random position. The robot has to reach the position and then come back to the user. The robot can reach the Play state only from the Normal state and only when a "Play" command is recived.<br />
<br />
 The software architecture is composed by four elements: IMAGE</p><ul>
<li><b>User Command</b>: it represents the user command "play"</li>
<li><b>Command Manager</b>: it is the main part of the architecture in which the <b>FSM</b> is.</li>
<li><b>Navigation</b>: it manages the motion of the robot and brings it to the new position</li>
<li><b>Random Position Generator</b>: generates random positions</li>
</ul>
<p>Navigation and Random Position Generator are services because they are thought to operate in a syncronous mode; they will generate a new position and move the robot to the generated position only when it is specifically requested from the code. While, User Command is meant to be a node because it has to behave in an asyncronous mode (it must send a command randomly).</p>
<ul>
<li><b><a class="el" href="usr__cmd_8cpp.html" title="In this file the publisher to the topic &quot;hw1_usr_cmd&quot; is initialized. ">usr_cmd.cpp</a></b></li>
<li><b><a class="el" href="rand__position_8cpp.html" title="In this file the service &quot;random_position&quot; is initialized. ">rand_position.cpp</a></b><ol type="1">
<li></li>
<li></li>
</ol>
</li>
<li><b><a class="el" href="navigation_8cpp.html" title="In this file the service &quot;reach_new_position&quot; is initialized. ">navigation.cpp</a></b></li>
<li><b><a class="el" href="state__machine_8py.html" title="FSM of the architecture. ">state_machine.py</a></b> is the core node , that manages information from the two previous publishers and implements a <em>Finite State Machine</em> which alternates the three possible states (<b>PLAY</b>,<b>NORMAL</b> and <b>SLEEP</b>). Finally in according to them it makes some requests to the <em>Navigation</em> service in order to move the robot. It should be noted that this node continuously receives positions from the <em>getPosition</em> node but simply ignores such information when it is in a finite state where those data is not needed.</li>
</ul>
<h2>Finite State Machine</h2>
<p>The finite state machine, present in the <em>commandManager</em> node, was developed as follows:</p><ul>
<li><b>NORMAL</b> : First of all <em>NORMAL</em> is the initial state. In this state the <em>FSM</em> checks if the <em>state</em> variable (which contains the strings published from the <em>speakPerception</em> node) is equal to the string <em>play</em>. In that case the <em>FSM</em> goes in <em>PLAY</em> state. Otherwise it makes a request to the <em>Navigation</em> service to go in a random position provided by the <em>getPosition</em> node. Then this routine is iterated for a random number of times (max 3 times) after which the robot goes in <em>SLEEP</em> mode.</li>
<li><b>PLAY</b> : In this state the <em>commandManager</em> moves the robot to the goal position which is just the last position sent by the <em>getPosition</em> node. Then it call again the <em>Navigation</em> service sending as goal position the user position, in order to tell the robot to come back to the user. After then that the <em>FSM</em> come back in <em>NORMAL</em> mode.</li>
<li><b>SLEEP</b> : The robot goes to the home which is a known position a priori chosen. Then it sleeps for a random time after which the <em>FSM</em> goes in NORML mode.</li>
</ul>
<h2>Installation</h2>
<p>In order to use this package it's necessary to install the <em>smach</em> library which allows to implement a <em>Finite State Machine</em>. So on a command window digit: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo apt-get install ros-kinetic-smach-viewer</div></div><!-- fragment --><p> Of coure it's also required to make a <em>catkin_make</em> in your <em>ROS</em> workspace </p><h3>File list</h3>
<p>In this package you can find in the <em>src</em> directory the three nodes file and the service. In the <em>launch</em> directory has been defined several launch files to test the system (<em>assignment1.launch</em> launches every components of the system). <em>srv</em> directory contains the definition of the only service of the architecture. Finally you can find three <em>bash command file</em> usefull to test the system avoiding to digit long terminals commands :</p><ul>
<li><b>run_sys.sh</b> allows to launch all componets of the system without the <em>getPosition_node</em></li>
<li><em><b>run_gesPosition.sh</b> launches the _getPosition</em> node</li>
<li><b>impossiblePosition.sh</b> just publishes on the <em>Position</em> topic a position messagge which is out of the map. This is usefull to test the response of the system in case the user points a position which is not reachable from the robot.</li>
</ul>
<h2>Usage</h2>
<p>First of all remeber to source your wrokspace in every terminal you will use. If wou want run the whole project just type: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ roslaunch assignment1 assignment1.launch</div></div><!-- fragment --> <h3>Test getPosition</h3>
<p>In order to test in two different terminals the messages random generates by the <em>getPosition</em> node and see the their effects, plese go to the <em>assignment1</em> directory and execute from shell: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/assignment1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ ./run_getPosition.sh</div></div><!-- fragment --><p> and then in another terminal execute </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/assignment1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ ./run_sys.sh</div></div><!-- fragment --><p> You will see in first terminal window the positions randomly generated by <em>getPostion</em> and the response in real time of the <em>commandManager</em> node. ### Test impossible position </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/assignment1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ ./run_sys.sh</div></div><!-- fragment --><p> and in a new terminal execute </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/assignment1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ ./impossiblePosition.sh</div></div><!-- fragment --><p> <br />
 <br />
 <br />
</p>
<p><b>Robotics Engineering Master - 2nd year</b> <br />
 <b>University of Genoa</b> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
