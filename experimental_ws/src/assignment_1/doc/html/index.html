<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Assignment_1: Behavioral Architecture - Assignment 1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Assignment_1
   &#160;<span id="projectnumber">v.1</span>
   </div>
   <div id="projectbrief">Behavioral Architecture</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Behavioral Architecture - Assignment 1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><b>Author:</b> Roberto Albanese</li>
<li><b>Version:</b> 1.0</li>
<li><b>Date:</b> 10-28-2020</li>
</ul>
<h2>Indrodution</h2>
<p>This is the first assignment of the course <em>Experimental Robotics</em>. I am asked to build an ROS architecture to implement a dog alike robotâ€™s behavior. In this project folder the reader will encounter the following folders:</p><ul>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/doc/html">doc</a> Doxygen documentation;</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/launch">launch</a> Launch files;</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/src">src</a> Source files;</li>
<li><a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/srv">srv</a> Service files.</li>
</ul>
<h2>Software Architecture and System's Features</h2>
<p>The scenario is represented by a robot, simulating a pet, that interacts with a human and moves in a discrete 2D environment. <br />
 The robot has three possible behaviors: it can Sleep, Play or stay in a Normal state.<br />
<br />
 In the Normal state the robot has to move randomly.<br />
<br />
 In the Sleep state the robot chooses a random location and sleep there for a random amount of time. Then it goes back in the Normal state. The robot can pass to the Spleep state only from the Normal state in a random time instant.<br />
<br />
 In the Play state the robot reaches the User and waits until it points to a random position. The robot has to reach the position and then come back to the user. The robot can reach the Play state only from the Normal state and only when a "Play" command is recived. The robot can remain in the Play state for multiple iterations.<br />
<br />
 The software architecture is composed by four elements: </p><div class="image">
<img src="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/blob/master/experimental_ws/src/assignment_1/Architecture.jpg"  alt="alt text"/>
</div>
<ul>
<li><b>User Command</b>: it represents the user command "play";</li>
<li><b>Command Manager</b>: it is the main part of the architecture in which the <b>FSM</b> is;</li>
<li><b>Navigation</b>: it manages the motion of the robot and brings it to the new position;</li>
<li><b>Random Position Generator</b>: generates random positions.</li>
</ul>
<p>Navigation and Random Position Generator are services because they are thought to operate in a syncronous mode. They will generate a new position and move the robot to the generated position only when it is specifically requested from the code. On the other hand, User Command is meant to be a node because it has to behave in an asyncronous mode (it must send a command randomly). </p><h3>File list</h3>
<p>In the <a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/src">source folder</a> it is possible to find four files which compose the whole architecture:</p>
<ul>
<li><b><a class="el" href="usr__cmd_8cpp.html" title="In this file the publisher to the topic &quot;hw1_usr_cmd&quot; is initialized. ">usr_cmd.cpp</a></b>: it is the only node leaving out the state machine. In here I have defined a publisher which randomly publishes a string "Play" in the topic <em>hw1_usr_cmd</em>;</li>
<li><b><a class="el" href="rand__position_8cpp.html" title="In this file the service &quot;random_position&quot; is initialized. ">rand_position.cpp</a></b>: it is the fist service of the architecture. It waits for a request message of the type <em>get_pos.srv</em> and randomly generates a 2D position;</li>
<li><b><a class="el" href="navigation_8cpp.html" title="In this file the service &quot;reach_new_position&quot; is initialized. ">navigation.cpp</a></b>: it is the second service of the architecture. It waits for a request message of the type <em>reach_next_pos.srv</em> in which it is present the new position where the robot needs to go, waits for a reasonable amount of time to simulate a motion, and gives as response the new current position;</li>
<li><b><a class="el" href="state__machine_8py.html" title="FSM of the architecture. ">state_machine.py</a></b> is the core node that manages information from the two services and the publisher. It initializes and executes a state machine, using the library <em>smach_ros</em>, in which all the three states and their behaviours are defined.<br />
</li>
</ul>
<p>In the <a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/srv">service folder</a> is it possible to find the two files used by the services:</p><ul>
<li><b>get_pos.srv</b>: the request part of the message represents the boundaries of the map. The service cannot generate a random position outside of the map. The respose part represents the new generated random position. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int64 minx</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int64 maxx</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;int64 miny</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;int64 maxy</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;---</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;int64 x</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;int64 y</div></div><!-- fragment --></li>
<li><b>reach_next_pos.srv</b>:the request part of the message is formed by the new position that the robot has to reach while the response part represents the new current position after the motion. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int64 x</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;int64 y</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;---</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;int64 x</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;int64 y</div></div><!-- fragment --> In the <a href="https://github.com/robertoalbanese/Experimental-Robotics-Laboratory/tree/master/experimental_ws/src/assignment_1/launch">launch folder</a> it is present the launch file used to execute all the nodes.</li>
</ul>
<h2>Installation</h2>
<p>There are few steps to follow before to being able to execute the code. Firs of all we need to intall the <em>smach</em> library to let ROS to work with finite state machines: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo apt-get install ros-kinetic-smach-viewer</div></div><!-- fragment --><p> It's also required to make a <em>catkin_make</em> in your <em>ROS</em> workspace. Check <a href="http://wiki.ros.org/catkin/Tutorials">ROS tutorials</a> to see how to do it.</p>
<h2>Usage</h2>
<p>First of all it is required to source your workspace setup.bash file. If wou want run the whole project just type: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ roslaunch assignment_1 assignment_1.launch</div></div><!-- fragment --><p> The launch file is done in a way that it makes possible to see the state of the <b>FSM</b> in the <em>smach_viewer</em> node automatically.<br />
 In the terminal in which the roslaunch command is executed it is possible to see the current positions of the robot.<br />
<br />
 In order to manually execute the nodes/services to see in each terminal the data generated from each node/service, it is required to <em>rosrun</em> each node/service listed in <em>assignment_1.launch</em> in the exact same order they are listed in. </p><h2>Software Limitation and Possible technical Improvements</h2>
<h3>Limitations</h3>
<ul>
<li>The system generates randomly the boundaries of the map and the position of the user and it's not implemented a routine to accept these information from a configuration file yet;</li>
<li>It is not implemented a routine to check if the new randomly generated position is inside or outside of the boundaries of the map. <h3>Possible Improvements</h3>
</li>
</ul>
<ul>
<li>Recive informations, as the map or the position of the user, from a configuration file;</li>
<li>Let the user change his/her position during the execution;</li>
<li>Add a microphone sensor to the robot, so that the user can command the robot by speech;</li>
<li>Implement a real navigation algorithm;</li>
<li>Add more states as Eat or Drink. <h2>Contacts</h2>
</li>
</ul>
<p>Roberto Albanese <a href="#" onclick="location.href='mai'+'lto:'+'ral'+'ba'+'nes'+'e1'+'8@g'+'ma'+'il.'+'co'+'m'; return false;">ralba<span style="display: none;">.nosp@m.</span>nese<span style="display: none;">.nosp@m.</span>18@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a> <br />
 <br />
 <br />
</p>
<p><b>Robotics Engineering Master - 2nd year</b> <br />
 <b>University of Genoa</b> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
